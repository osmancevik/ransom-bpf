# /etc/ransom-bpf/ransom.conf
# RansomBPF Configuration File - v0.9.0
#
# This file controls the behavioral analysis engine, risk scoring thresholds,
# and operational settings of the RansomBPF agent.
#
# Syntax: KEY=VALUE (No spaces around '=')
# Lines starting with '#' are comments.

# -----------------------------------------------------------------------------
# [GENERAL SETTINGS]
# -----------------------------------------------------------------------------

# Analysis Window (Seconds)
# The duration for which the event counters are kept before decay/reset.
# A shorter window makes the system more responsive but may miss "slow" attacks.
WINDOW_SEC=10

# Verbose Mode
# Set to 1 to enable debug output to stdout (useful for troubleshooting).
# Default: 0 (Production/Silent Mode)
VERBOSE=0


# -----------------------------------------------------------------------------
# [RISK SCORING ENGINE]
# -----------------------------------------------------------------------------
# The total risk score is calculated cumulatively. If the score exceeds
# the RISK_THRESHOLD within the analysis window, an alarm/action is triggered.

# Risk Threshold
# The cumulative score limit that triggers a response.
# Example Calculation: 50 Writes (50*2) = 100 Points -> ALARM
RISK_THRESHOLD=100

# Event Weights (Points per Action)
SCORE_WRITE=2       # File Modification (Low risk, happens frequently)
SCORE_RENAME=20     # File Renaming (Medium risk, typical of ransomware)
SCORE_UNLINK=50     # File Deletion (High risk, used for removing backups)
SCORE_HONEYPOT=1000 # Honeypot Access (Critical risk, immediate trigger)

# Penalty for Suspicious Extensions
# Additional points added if a file is renamed to a known ransomware extension
# (e.g., .locked, .enc, .cry).
SCORE_EXT_PENALTY=50


# -----------------------------------------------------------------------------
# [SECURITY & ACTIVE DEFENSE]
# -----------------------------------------------------------------------------

# Active Blocking (IPS Mode)
# If set to 'true' or '1', the agent will automatically KILL the suspicious
# process when the risk threshold is exceeded.
# Set to 'false' for Detection-Only (IDS) mode.
ACTIVE_BLOCKING=true

# Honeypot File
# The name of the trap file to monitor. Access to this file is considered
# a high-fidelity indicator of compromise.
# Can be a full path or just a filename.
HONEYPOT_FILE=secret_passwords.txt

# Whitelist (Trusted Processes)
# Comma-separated list of process names to exclude from analysis.
# Critical for performance and preventing false positives on system tools.
WHITELIST=systemd,systemd-journal,sshd,rsyslogd,bash,vi,vim,nano,ls,grep,sed,awk,git,gcc,make,cmake


# -----------------------------------------------------------------------------
# [LOGGING CONFIGURATION]
# -----------------------------------------------------------------------------

# Service Log
# General application logs (startup, shutdown, errors).
SERVICE_LOG=/var/log/ransom-bpf/service.log

# Alert Log (JSON)
# High-priority security alerts. Use this for SIEM integration.
ALERT_LOG=/var/log/ransom-bpf/alerts.json

# Audit Log (JSON)
# Raw stream of all file system events (Optional: Can generate large files).
AUDIT_LOG=/var/log/ransom-bpf/audit.json